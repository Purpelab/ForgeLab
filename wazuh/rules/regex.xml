<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                                                                                                                     ‚ïë
‚ïë       8 8888888888       ,o888888o.     8 888888888o.       ,o888888o.    8 8888888888   8 8888                  .8.          8 888888888o          ‚ïë
‚ïë       8 8888          . 8888     `88.   8 8888    `88.     8888     `88.  8 8888         8 8888                 .888.         8 8888    `88.        ‚ïë
‚ïë       8 8888         ,8 8888       `8b  8 8888     `88  ,8 8888       `8. 8 8888         8 8888                :88888.        8 8888     `88        ‚ïë
‚ïë       8 8888         88 8888        `8b 8 8888     ,88  88 8888           8 8888         8 8888               . `88888.       8 8888     ,88        ‚ïë
‚ïë       8 888888888888 88 8888         88 8 8888.   ,88'  88 8888           8 888888888888 8 8888              .8. `88888.      8 8888.   ,88'        ‚ïë
‚ïë       8 8888         88 8888         88 8 888888888P'   88 8888           8 8888         8 8888             .8`8. `88888.     8 8888888888          ‚ïë
‚ïë       8 8888         88 8888        ,8P 8 8888`8b       88 8888   8888888 8 8888         8 8888            .8' `8. `88888.    8 8888    `88.        ‚ïë
‚ïë       8 8888         `8 8888       ,8P  8 8888 `8b.     `8 8888       .8' 8 8888         8 8888           .8'   `8. `88888.   8 8888      88        ‚ïë
‚ïë       8 8888          ` 8888     ,88'   8 8888   `8b.      8888     ,88'  8 8888         8 8888          .888888888. `88888.  8 8888    ,88'        ‚ïë
‚ïë       8 8888             `8888888P'     8 8888     `88.     `8888888P'    8 888888888888 8 888888888888 .8'       `8. `88888. 8 888888888P          ‚ïë
‚ïë                                                                                                                                                     ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                                   Regex Rules - 100400                                                              ‚ïë
‚ïë                                                                   Author: amaz974 & CupOfCoffeeX                                                    ‚ïë
‚ïë                                                             Description : Le but est de d√©tect√© la lecture et la copie de fichier sensible          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
-->

<!-- 
On se base sur la r√®gle 80792 qui surveille l'ex√©cution de commandes syst√®me, lorsque cette r√®gle se d√©clenche on v√©rifie la pr√©sence du regex et l√®ve une alerte si le champ est trouv√©
-->

<group name="regex">
   
    
    <rule id="100401" level="15">
    <if_sid>80792</if_sid>
    <description>üß© la commande $(audit.command) $(audit.execve.a1) a √©t√© d√©t√©ct√© üß©</description>
    <regex>/etc/passwd|etc/passwd|e[^a-zA-Z]*tc/passwd|passwd|/etc/shadow|etc/shadow|e[^a-zA-Z]*tc/shadow|shadow/|/proc/net|proc/net|/proc/net|proc[^a-zA-Z]*net</regex>
    <field name="audit.command">cat|less|nano|vim|vi|more|head|tail|strings|awk|grep|egrep|sed|tac|view|ed|cp|mv</field> <!-- Par exemple, vous pouvez ajuster ce champ √† la commande cible -->

        <info>
            Cette r√®gle d√©tecte un acc√®s √† un fichier sensible.
            **Champs int√©ressants √† regarder :**
             - Utilisateur
             - data.audit.execve*
            
            **Que faire en cas de cette alerte :**
            1. V√©rifiez si la commande √©tait l√©gitime et autoris√©e.
            2. Si la commande n'√©tait pas autoris√©e, identifiez l'utilisateur et le processus responsable.
        </info>

    <mitre>
        <id>T1065</id>
    </mitre>
    <group>,regex, auditd, critical, file access  </group>
    </rule>

</group>
    
    
